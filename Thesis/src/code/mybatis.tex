
\begin{lstlisting}[language=Java, caption={Example of query and insert operations using \citet{MyBatis}}, label={code:mybatis}]
public DatabaseValue getForId(int id) throws Exception {
  SqlSessionFactory sqlSessionFactory = createSqlSessionFactory(); /*\label{code:mybatis:sqlSessionFactory}*/
  try (SqlSession sqlSession = sqlSessionFactory.openSession()) {
    Mapper mapper = sqlSession.getMapper(Mapper.class); /*\label{code:mybatis:getMapper}*/
    return mapper.getForId(id); /*\label{code:mybatis:return}*/
  }
}

public void insert(DatabaseValue value) throws Exception {
  SqlSessionFactory sqlSessionFactory = createSqlSessionFactory();
  try (SqlSession sqlSession = sqlSessionFactory.openSession()) {
    Mapper mapper = sqlSession.getMapper(Mapper.class);
    mapper.insert(value);
  }
}
\end{lstlisting}
